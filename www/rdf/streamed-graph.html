<link rel="import" href="/lib/polymer/1.0.9/polymer/polymer.html">


<dom-module id="streamed-graph">
  <template>
    <style>
     div {
         display: inline-block;
         width: 25em;
         border: 1px solid gray;
         background: #BFBFBF;
     }
    </style>
    <div>StreamedGraph: {{status}}</div>
  </template>
  <script src="/lib/require/require-2.3.3.js"></script>
  <script>
   require.config({
       paths: {
           "streamed-graph": "/rdf/streamed-graph",
           "quadstore-module": "/rdf/quadstore",
           "async-module": "/lib/async/80f1793/async",
           "jsonld-module": "/lib/jsonld.js/0.4.5/js/jsonld",
           "rdfstore-module": "/lib/rdf_store/0.9.7/dist/rdfstore",
       }
   });
   require(['streamed-graph'], function(streamed_graph) {
       Polymer({
           is: "streamed-graph",
           properties: {
               graph: {type: Object, notify: true, value: {version: 0, graph: null}},
               url: {type: String, notify: true, observer: '_onUrl'},
               status: {type: String, notify: true, value: 'startup...'},
           },
           _onUrl: function(url) {
               if (this.sg) { this.sg.close(); }
               this.sg = new streamed_graph.StreamedGraph(
                   url, this.onGraphChanged.bind(this), this.set.bind(this, 'status'));
           },
           onGraphChanged: function() {
               this.graph = {version: this.graph.version + 1, graph: this.sg };
           }
       });

   });
  </script>
</dom-module>

