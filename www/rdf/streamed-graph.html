<link rel="import" href="/lib/polymer/1.0.9/polymer/polymer.html">


<dom-module id="streamed-graph">
  <template>
    <style>
     div {
         display: inline-block;
         width: 25em;
         border: 1px solid gray;
         background: #BFBFBF;
     }
    </style>
    <div>StreamedGraph: {{status}}</div>
  </template>
  <script>
   requirejs(['streamed-graph'], function(streamed_graph) {
       Polymer({
           is: "streamed-graph",
           properties: {
               graph: {type: Object, notify: true, value: {version: 0, graph: null}},
               url: {type: String, notify: true, observer: '_onUrl'},
               status: {type: String, notify: true, value: 'startup...'},
           },
           _onUrl: function(url) {
               if (this.sg) { this.sg.close(); }
               this.sg = new streamed_graph.StreamedGraph(
                   url, this.onGraphChanged.bind(this), this.set.bind(this, 'status'));
           },
           onGraphChanged: function() {
               this.graph = {version: this.graph.version + 1, graph: this.sg };
           }
       });
   });

  </script>
</dom-module>

